{
    "name": "otrs",
    "version": "1.0.1",
    "label": "OTRS",
    "description": "Creates, modifies, and searches tickets within OTRS",
    "publisher": "Fortinet",
    "icon_small_name": "OTRS_32X32.png",
    "icon_large_name": "OTRS_80X80.png",
    "category": "Service Management/Ticketing System",
    "configuration": {
        "fields": [
            {
                "title": "Host URL",
                "type": "text",
                "name": "url",
                "required": true,
                "visible": true,
                "editable": true
            },
            {
                "title": "Username",
                "type": "text",
                "name": "username",
                "required": true,
                "visible": true,
                "editable": true
            },
            {
                "title": "Password",
                "type": "password",
                "name": "password",
                "required": true,
                "visible": true,
                "editable": true
            }
        ]
    },
    "operations": [
        {
            "operation": "create_ticket",
            "category": "miscellaneous",
            "annotation": "create_ticket",
            "output_schema": {
                "ticket_metadata": {}
            },
            "title": "Create Ticket",
            "description": "Create a new OTRS ticket with mandatory data",
            "enabled": true,
            "parameters": [
                {
                    "title": "Title",
                    "type": "text",
                    "name": "title",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Ticket title"
                },
                {
                    "title": "Queue",
                    "type": "text",
                    "name": "queue",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Queue for this ticket to go into"
                },
                {
                    "title": "State",
                    "type": "select",
                    "name": "state",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Initial state of this ticket",
                    "options": [
                        "open",
                        "New",
                        "Requested",
                        "Pending Approval",
                        "Rejected",
                        "Approved",
                        "In Progress",
                        "Pending PIR",
                        "Successful",
                        "Failed",
                        "Canceled",
                        "Retracted"
                    ]
                },
                {
                    "title": "Priority",
                    "type": "select",
                    "name": "priority",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Priority level for this ticket",
                    "options": [
                        "1 very low",
                        "2 low",
                        "3 normal",
                        "4 high",
                        "5 very high"
                    ]
                },
                {
                    "title": "Customer User",
                    "type": "text",
                    "name": "customer",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Name of the customer user for this ticket"
                },
                {
                    "title": "Article Subject",
                    "type": "text",
                    "name": "article_subject",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Subject text to use for this ticket's initial article"
                },
                {
                    "title": "Article Body",
                    "type": "text",
                    "name": "article_body",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Body text for this ticket's initial article"
                }
            ],
            "open": false
        },
        {
            "operation": "search_tickets",
            "category": "miscellaneous",
            "annotation": "search_ticket",
            "output_schema": {
                "count": "integer",
                "matches": {}
            },
            "title": "Search Tickets",
            "description": "Search tickets by title, state",
            "enabled": true,
            "parameters": [
                {
                    "title": "Ticket Title",
                    "type": "text",
                    "name": "ticket_title",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Ticket title to search for"
                },
                {
                    "title": "State",
                    "type": "multiselect",
                    "name": "state",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "tooltip": "State of this ticket",
                    "options": [
                        "new",
                        "open",
                        "pending reminder",
                        "Requested",
                        "Pending Approval",
                        "Rejected",
                        "Approved",
                        "In Progress",
                        "Pending PIR",
                        "Successful",
                        "Failed",
                        "Canceled",
                        "Retracted"
                    ]
                },
                {
                    "title": "Ticket-Type",
                    "type": "multiselect",
                    "name": "tickettype",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Type of this ticket",
                    "options": [
                        "Vulnerability (VAS)",
                        "DC",
                        "Others"
                    ]
                }
            ],
            "open": false
        },
        {
            "operation": "get_ticket",
            "category": "miscellaneous",
            "annotation": "get_ticket",
            "output_schema": {
                "ticket": {}
            },
            "title": "Get Ticket",
            "description": "Fetch an OTRS ticket by ID",
            "enabled": true,
            "parameters": [
                {
                    "title": "Ticket ID",
                    "type": "text",
                    "name": "ticket_id",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Ticket ID to be updated"
                }
            ],
            "open": false
        },
        {
            "operation": "update_ticket",
            "category": "miscellaneous",
            "annotation": "update_ticket",
            "output_schema": {
                "ticket_metadata": {}
            },
            "title": "Update Ticket",
            "description": "Update an existing OTRS ticket data",
            "enabled": true,
            "parameters": [
                {
                    "title": "Ticket ID",
                    "type": "text",
                    "name": "ticket_id",
                    "required": true,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Ticket ID to be updated"
                },
                {
                    "title": "Title",
                    "type": "text",
                    "name": "title",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Ticket title"
                },
                {
                    "title": "Queue",
                    "type": "text",
                    "name": "queue",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Queue for this ticket to go into"
                },
                {
                    "title": "State",
                    "type": "select",
                    "name": "state",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Updated state of this ticket",
                    "options": [
                        "Requested",
                        "Pending Approval",
                        "Rejected",
                        "Approved",
                        "In Progress",
                        "Pending PIR",
                        "Successful",
                        "Failed",
                        "Canceled",
                        "Retracted"
                    ]
                },
                {
                    "title": "Priority",
                    "type": "select",
                    "name": "priority",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Priority level for this ticket",
                    "options": [
                        "1 very low",
                        "2 low",
                        "3 normal",
                        "4 high",
                        "5 very high"
                    ]
                },
                {
                    "title": "Customer User",
                    "type": "text",
                    "name": "customer",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Name of the customer user for this ticket"
                },
                {
                    "title": "Article Subject",
                    "type": "text",
                    "name": "article_subject",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Subject text to use for this ticket's updated article"
                },
                {
                    "title": "Article Body",
                    "type": "text",
                    "name": "article_body",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Body text for this ticket's updated article"
                },
                {
                    "title": "DynamicField",
                    "type": "json",
                    "name": "dynamicField",
                    "required": false,
                    "visible": true,
                    "editable": true,
                    "tooltip": "Other Fields, like Dynamic Fields"
                }
            ],
            "open": false
        }
    ],
    "forked_from": "otrs_1_0_0",
    "cs_approved": true,
    "cs_compatible": true,
    "help_online": "https://help.cybersponse.com/support/solutions/articles/17000074818-otrs-v1-0-0"
}